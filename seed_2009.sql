-- DROP DATABASE IF EXISTS sedd_2009_db;
-- CREATE DATABASE sedd_2009_db;
USE project2;
SET sql_mode = ' ';
DROP TABLE IF EXISTS sedd_2009;
CREATE TABLE sedd_2009
(AGE INT,
AHOUR TIME,
AWEEKEND INT,
DIED INT,
DISPUNIFORM INT,
DQTR INT,
DSHOSPID VARCHAR(10),
DX1 VARCHAR(7),
DX2 VARCHAR(7),
DX3 VARCHAR(7),
DX4 VARCHAR(7),
DX5 VARCHAR(7),
DX6 VARCHAR(7),
DX7 VARCHAR(7),
DX8 VARCHAR(7),
DX9 VARCHAR(7),
DX10 VARCHAR(7),
DX_Visit_R1 VARCHAR(7),
DaysToEvent INT,
ECODE1 VARCHAR(7),
ECODE2 VARCHAR(7),
ECODE3 VARCHAR(7),
FEMALE INT,
HCUP_AS INT,
HCUP_ED INT,
HCUP_OS INT,
HOSPBIRTH INT,
HOSPST VARCHAR(2),
Homeless INT,
keyy BIGINT,
LOS INT,
MDNUM1_R VARCHAR(20),
MDNUM2_R VARCHAR(20),
MDNUM3_R VARCHAR(20),
MEDINCSTQ INT,
NCHRONIC INT,
NDX INT,
NECODE INT,
NEOMAT INT,
NPR INT,
ORPROC INT,
PAY1 INT,
PL_RUCA10_2005 INT,
PR1 VARCHAR(10),
PR2 VARCHAR(10),
PR3 VARCHAR(10),
PR4 VARCHAR(10),
PR5 VARCHAR(10),
PROCTYPE INT,
RACE INT,
STATE_AS INT,
STATE_ED INT,
STATE_OS INT,
TOTCHG INT,
VisitLink BIGINT,
Yea_R YEAR,
ZIPINC_QRTL INT,
AYEAR YEAR
)MAX_ROWS=6000000;
LOAD DATA INFILE 'C:/ProgramData/MySQL/MySQL Server 5.7/Uploads/sedd_2009_updated.csv'
INTO TABLE sedd_2009 
FIELDS TERMINATED BY ','
LINES TERMINATED BY '\n'
IGNORE 1 LINES
(
AGE,
@var1,
AWEEKEND,
DIED,
DISPUNIFORM,
DQTR,
DSHOSPID,
DX1,
DX2,
DX3,
DX4,
DX5,
DX6,
DX7,
DX8,
DX9,
DX10,
DX_Visit_R1,
DaysToEvent,
ECODE1,
ECODE2,
ECODE3,
FEMALE,
HCUP_AS,
HCUP_ED,
HCUP_OS,
HOSPBIRTH,
HOSPST,
Homeless,
keyy,
LOS,
MDNUM1_R,
MDNUM2_R,
MDNUM3_R,
MEDINCSTQ,
NCHRONIC,
NDX,
NECODE,
NEOMAT,
NPR,
ORPROC,
PAY1,
PL_RUCA10_2005,
PR1,
PR2,
PR3,
PR4,
PR5,
PROCTYPE,
RACE,
STATE_AS,
STATE_ED,
STATE_OS,
TOTCHG,
VisitLink,
Yea_R,
ZIPINC_QRTL,
AYEAR
)
SET AHOUR = STR_TO_DATE(@var1,'%k%i');